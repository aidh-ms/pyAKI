DROP VIEW
  IF EXISTS mimiciv_custom.pyaki_test_demographics CASCADE;

CREATE VIEW
  mimiciv_custom.pyaki_test_demographics AS (
    SELECT
      stay_id,
      subject_id,
      los_icu,
      icu_intime,
      icu_outtime,
      gender,
      admission_age,
      ethnicity
    FROM
      mimiciv_derived.icustay_detail
    WHERE
      subject_id IN ( -- random selection of subject ids from mimic_demo
        10000032,
        10001217,
        10001725,
        10002428,
        10002495,
        10002930,
        10003046,
        10003400,
        10004235,
        10004422,
        10004457,
        10004720,
        10004733,
        10005348,
        10005817,
        10005866,
        10005909,
        10006053,
        10006580,
        10007058,
        10007795,
        10007818,
        10007928,
        10008287,
        10008454,
        10009035,
        10009049,
        10009628,
        10010471,
        10010867,
        10011398,
        10012552,
        10012853,
        10013049,
        10014078,
        10014354,
        10014729,
        10015272,
        10015860,
        10015931,
        10016150,
        10016742,
        10016810,
        10017492,
        10018081,
        10018328,
        10018423,
        10018501,
        10018845,
        10019003,
        10019172,
        10019385,
        10019568,
        10019777,
        10019917,
        10020187,
        10020306,
        10020640,
        10020740,
        10020786,
        10020944,
        10021118,
        10021312,
        10021487,
        10021666,
        10021938,
        10022017,
        10022041,
        10022281,
        10022880,
        10023117,
        10023239,
        10023771,
        10024043,
        10025463,
        10025612,
        10026255,
        10026354,
        10026406,
        10027445,
        10027602,
        10029291,
        10029484,
        10031404,
        10031757,
        10032725,
        10035185,
        10035631,
        10036156,
        10037861,
        10037928,
        10037975,
        10038081,
        10038933,
        10038992,
        10038999,
        10039708,
        10039831,
        10039997,
        10040025
      )
  );